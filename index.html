<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Project Index</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
    body {
        font-family: Arial, sans-serif;
        background: #f5f6fa;
        margin: 0;
        padding: 40px;
    }
    h1 {
        text-align:center;
        margin-bottom: 40px;
        color: #333;
    }
    #folders {
        max-width: 800px;
        margin: 0 auto;
        display: grid;
        gap: 20px;
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    }
    .item {
        padding: 20px;
        background: white;
        border-radius: 10px;
        box-shadow: 0 2px 5px rgba(0,0,0,0.15);
        text-align: center;
        font-size: 18px;
        transition: transform .2s, box-shadow .2s;
    }
    .item:hover {
        transform: translateY(-4px);
        box-shadow: 0 4px 10px rgba(0,0,0,0.25);
    }
    .item a {
        text-decoration: none;
        color: #0077cc;
        font-weight: bold;
    }
</style>
</head>
<body>

<h1>Available Sections</h1>

<div id="folders">Loadingâ€¦</div>

<script type="module">
    import { API } from './github-api.js';

    // 1. redirect if URL has parameters (your existing logic)
    if (API.urlParams.has("endpoint")) {
        API.redirectToRelativeEndPoint(API.urlParams.get('endpoint'));
    } else {
        // 2. auto-fetch folders from GitHub
        const list = document.getElementById("folders");

            async function loadFolders() {
                const url =
                `https://api.github.com/repos/${API.repoOwner}/${API.repoName}contents/`;

                try {
                    const response = await fetch(url);
                    const data = await response.json();

                    list.innerHTML = "";

                    data
                    .filter(item => item.type === "dir")
                    .forEach(entry => {
                        const div = document.createElement("div");
                        div.className = "item";
                        console.log(entry.name);
                        div.innerHTML = `<a href="./${entry.name}/">${entry.name}</a>`;
                        list.appendChild(div);
                    });

                } catch (e) {
                    list.innerHTML = "Error loading folders.";
                }
            }

            loadFolders();
        }
</script>

</body>
</html>